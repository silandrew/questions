
        _collector=ecom-aws-prod and _sourceName=ahserver and ("<AuthProcessor>" or "<AuthText>")
	| json "log.mdc.transactionld" as txid
	| transactionize txld maxSpan=1m (merge txid takeFirst, _raw join with "\n\n\n")
	| parse "<AuthProcessor>*</AuthProcessor>" as authprocessor nodrop
        | parse *<AuthText>*</AuthText>“ as authtext nodrop
        | parse "<AcceptorName>*</AcceptorName>" as acceptorName nodrop
        | if (authtext contains "AUTH CODE", "APPROVED”, authtext) as authtext
        | if (authtext contains	“INVALID", "INVALID”,	authtext) as authtext
	| if (authtext contains	"EXPIRED", EXPIRED", authtext) as authtext
	| if (authtext contains	"SIMULATED", "SIMULATED", authtext) as authtext
        | if (authtext contains	"DECLINE” or authtext	contains "DECL PICKUP CARD”, "DECLINED", authtext) as authtext
        | where (authtext !="")
	| lookup authprocessorname from lookups/authprocessor on authprocessor=authprocessorid
        | where authprocessorname "test and example
	| timeslice 15m
	| count by _timeslice, authtext
        | transponse row _timeslice column authtext
      
 count-distinct (acceptorName) as distinct Acceptors by authprocessorname, authtext, -timeslice I compare with
timeshift 7d 4
16	| where recordCount > 10 and dlstinctAcceptors > 2 and recordcount > (((recordCount_07d + recordCount_14d * recordCount_21d *
reeordCount_28d)/4) * 1.2)
I order by recordCount. authprocessorname, authtext


  2000000000   false            7d11h   PreemptLowerPriorit
  2000001000

 _collector=ecom-aws-prod and _sourceName=sagepay-authserver and ("<AuthProcessor>" or "<AuthText>")
	| json "log.mdc.transactionld" as txid
	| transactionize txld maxSpan=1m (merge txid takeFirst, _raw join with "\n\n\n")
	| parse "<AuthProcessor>*</AuthProcessor>" as authprocessor nodrop
        | parse *<AuthText>*</AuthText>“ as authtext nodrop
        | parse "<AcceptorName>*</AcceptorName>" as acceptorName nodrop
        | if (authtext contains "AUTH CODE", "APPROVED”, authtext) as authtext       
        | where (authtext !="")
	| lookup authprocessorname from lookups/authprocessor on authprocessor=authprocessorid
        | where authprocessorname "test and example"
	| timeslice 15m
	| count by _timeslice, authtext
        | transponse row _timeslice column authtext